<file path="system/engine/event.php">
    <operation>
        <search><![CDATA[
            $this->registry = $registry;
        ]]></search>
        <add position="after"><![CDATA[
            $this->register('model/setting/event/getEvents/after', new Action('common/awebcore/afterGetEvents'));
        ]]></add>
    </operation>
</file>
<file path="admin/controller/marketplace/modification.php">
    <operation>
        <search><![CDATA[$this->response->redirect($this->url->link(!empty($data['redirect']) ? $data['redirect'] : 'marketplace/modification', 'user_token=' . $this->session->data['user_token'] . $url, true));]]></search>
        <add position="before"><![CDATA[
if(isset($data['noredirect'])) {
	return true;
}
        ]]></add>
    </operation>
</file>
<file path="system/config/catalog.php">
    <operation>
        <search><![CDATA['event/debug/after']]></search>
        <add position="replace"><![CDATA[
	'event/language/after'
        ]]></add>
    </operation>
</file>
<file path="admin/controller/design/layout.php">
    <operation>
        <search><![CDATA[$this->load->language('extension/module/' . $part[0]);]]></search>
        <add position="replace"><![CDATA[
$this->load->language('extension/module/' . $part[0], 'layout_modules');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA['name'       => strip_tags($this->language->get('heading_title')),]]></search>
        <add position="replace"><![CDATA[
'name'       => strip_tags($this->language->get('layout_modules')->get('heading_title')),
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/account/wishlist.php">
    <operation>
        <search><![CDATA[$this->model_account_wishlist->addWishlist]]></search>
        <add position="before"><![CDATA[
$this->load->model('tool/image');
if ($product_info['image'])	{
$json['image'] = $this->model_tool_image->resize($product_info['image'], 80, 80);
} else {
$json['image'] = $this->model_tool_image->resize('placeholder.png', 80, 80);
}
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$json['total'] = sprintf($this->language->get('text_wishlist'), $this->model_account_wishlist->getTotalWishlist());]]></search>
        <add position="before"><![CDATA[
$json['link_wishlist'] = $this->url->link('account/wishlist', '', true);
$json['text_button_wishlist'] = $this->language->get('text_button_wishlist');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$json['total'] = sprintf($this->language->get('text_wishlist'), (isset($this->session]]></search>
        <add position="before"><![CDATA[
$json['link_login'] =  $this->url->link('account/login', '', true);
$json['text_button_login'] =  $this->language->get('text_button_login');
$json['link_register'] =  $this->url->link('account/register', '', true);
$json['text_button_register'] =  $this->language->get('text_button_register');
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/checkout/cart.php">
    <operation>
        <search><![CDATA[$this->document->setTitle]]></search>
        <add position="before"><![CDATA[
$data['text_payment_recurring'] = $this->language->get('text_payment_recurring');
$data['column_products'] = $this->language->get('column_products');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$json['success'] = sprintf]]></search>
        <add position="before"><![CDATA[
/*Default Theme changes START*/
$this->load->model('tool/image');
if ($product_info['image'])	{
$json['image'] = $this->model_tool_image->resize($product_info['image'], 80, 80);
} else {
$json['image'] = $this->model_tool_image->resize('placeholder.png', 80, 80);
}
$this->load->language('common/cart');
$json['text_checkout'] = $this->language->get('text_checkout');
$json['text_cart'] = $this->language->get('text_cart');
$json['link_checkout'] = $this->url->link('checkout/checkout', '', true);
$json['link_cart'] = $this->url->link('checkout/cart', '', true);
/*Default Theme changes END*/
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/common/cart.php">
    <operation>
        <search><![CDATA[$data['text_items']]]></search>
        <add position="before"><![CDATA[
$data['text_product'] = $this->language->get('text_product');
$data['text_products'] = $this->language->get('text_products');
$data['text_voucher'] = $this->language->get('text_voucher');
$data['text_vouchers'] = $this->language->get('text_vouchers');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[foreach ($this->cart->getProducts()]]></search>
        <add position="before"><![CDATA[
$data['products_quantity'] = 0;
$data['vouchers_quantity'] = 0;
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['products'][]]]></search>
        <add position="before"><![CDATA[
$data['products_quantity'] += $product['quantity'];
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['vouchers'][]]]></search>
        <add position="before"><![CDATA[
$data['vouchers_quantity'] += 1;
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['cart']]]></search>
        <add position="before"><![CDATA[
$data['vouchers_quantity'] = ($data['vouchers_quantity'] == 0) ? '' : (' + ' . ($data['vouchers_quantity'] == 1) ? $data['vouchers_quantity'] . ' ' . $this->language->get('text_voucher') : $data['vouchers_quantity'] . ' ' . $this->language->get('text_vouchers'));
$data['products_quantity'] = ($data['products_quantity'] == 1) ? $data['products_quantity'] . ' ' . $this->language->get('text_product') : $data['products_quantity'] . ' ' . $this->language->get('text_products');
$data['text_total'] = $this->language->get('text_total');
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/common/footer.php">
    <operation>
        <search><![CDATA[$data['scripts'] = $this->document->getScripts('footer');]]></search>
        <add position="after"><![CDATA[
$data['controller_newsletter'] = $this->load->controller('extension/module/colorix_newsletter');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$this->load->model('catalog/information');]]></search>
        <add position="before"><![CDATA[    
if ($this->request->server['HTTPS']) {
$server = $this->config->get('config_ssl');
} else {
$server = $this->config->get('config_url');
}

if (is_file(DIR_IMAGE . $this->config->get('config_logo'))) {
$data['logo'] = $server . 'image/' . $this->config->get('config_logo');
} else {
$data['logo'] = '';
}
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['newsletter']]]></search>
        <add position="before"><![CDATA[
$data['home'] = $this->url->link('common/home');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[return $this->load->view('common/footer', $data);]]></search>
        <add position="before"><![CDATA[
/*Default Theme changes START*/

$data['contact'] = $this->url->link('information/contact');

/*Default Theme changes END*/
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/common/header.php">
    <operation>
        <search><![CDATA[$this->load->model('account/wishlist');]]></search>
        <add position="after"><![CDATA[
$data['total_wishlist'] = $this->model_account_wishlist->getTotalWishlist();
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['text_wishlist'] = sprintf($this->language->get('text_wishlist'), $this->model_account_wishlist->getTotalWishlist());]]></search>
        <add position="replace"><![CDATA[
$data['text_wishlist'] = sprintf($this->language->get('text_wishlist'), $data['total_wishlist']);
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['text_wishlist'] = sprintf($this->language->get('text_wishlist'), (isset($this->session->data]]></search>
        <add position="before"><![CDATA[
$data['total_wishlist'] = (isset($this->session->data['wishlist']) ? count($this->session->data['wishlist']) : 0);
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['text_wishlist'] = sprintf($this->language->get('text_wishlist'), (isset($this->session->data['wishlist']) ? count($this->session->data['wishlist']) : 0));]]></search>
        <add position="replace"><![CDATA[
$data['text_wishlist'] = sprintf($this->language->get('text_wishlist'), $data['total_wishlist']);
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['text_logged'] = sprintf($this->language->get('text_logged'), $this->url->link('account/account', '', true), $this->customer->getFirstName(), $this->url->link('account/logout', '', true));]]></search>
        <add position="replace"><![CDATA[
$data['text_logged'] = sprintf($this->language->get('text_logged'), $this->customer->getFirstName());
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['logged']]]></search>
        <add position="before"><![CDATA[
// Compare
$data['compare_total_products'] = isset($this->session->data['compare']) ? count($this->session->data['compare']) : 0;
$data['text_compare'] = sprintf($this->language->get('text_compare'), $data['compare_total_products']);

$data['compare'] = $this->url->link('product/compare');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[return $this->load->view('common/header', $data);]]></search>
        <add position="before"><![CDATA[
// For page specific css
if (isset($this->request->get['route'])) {
    if (isset($this->request->get['product_id'])) {
        $class = '-' . $this->request->get['product_id'];
    } elseif (isset($this->request->get['path'])) {
        $class = '-' . $this->request->get['path'];
    } elseif (isset($this->request->get['manufacturer_id'])) {
        $class = '-' . $this->request->get['manufacturer_id'];
    } elseif (isset($this->request->get['information_id'])) {
        $class = '-' . $this->request->get['information_id'];
    } else {
        $class = '';
    }

    $data['class'] = str_replace('/', '-', $this->request->get['route']) . $class;
} else {
    $data['class'] = 'common-home';
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/common/menu.php">
    <operation>
        <search><![CDATA[$categories = $this->model_catalog_category->getCategories(0);]]></search>
        <add position="before"><![CDATA[
$total_products = $this->model_catalog_product->getTotalProductsByCategoryID();
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[($this->config->get('config_product_count') ? ' (' . $this->model_catalog_product->getTotalProducts($filter_data) . ')' : '')]]></search>
        <add position="replace"><![CDATA[(($this->config->get('config_product_count') && isset($total_products[$child['category_id']]) && $total_products[$child['category_id']] > 0) ? ' (' . $total_products[$child['category_id']] . ')' : '')]]></add>
    </operation>
    <operation>
        <search><![CDATA[$children_data[]]]></search>
        <add position="replace"><![CDATA[
            if(isset($total_products[$child['category_id']]) && $total_products[$child['category_id']] > 0){
                if($this->config->get('config_product_count')){
                    $child['name'] .= ' (' . $total_products[$child['category_id']] . ')';
                }
                
                $children_data[] = array(
                    'name'  => $child['name'],
                    'href'  => urldecode($this->url->link('product/category', 'path=' . $category['category_id'] . '_' . $child['category_id']))
                );
            }
        //unused variable
        $___children_data[]]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['categories'][]]]></search>
        <add position="replace"><![CDATA[
        if(count($children_data) || (isset($total_products[$category['category_id']]) && $total_products[$category['category_id']] > 0)) {
            $data['categories'][] = array(
                'name'     => $category['name'],
                'children' => $children_data,
                'column'   => $category['column'] ? $category['column'] : 1,
                'href'     => urldecode($this->url->link('product/category', 'path=' . $category['category_id']))
            );
        }
        //unused variable
        $__data['categories'][]]]></add>
    </operation>
</file>
<file path="catalog/controller/common/search.php">
    <operation>
        <search><![CDATA[return $this->load->view('common/search', $data);]]></search>
        <add position="before"><![CDATA[
/*Default Theme changes START*/

$data['text_category'] = $this->language->get('text_category');

if (isset($this->request->get['category_id'])) {
$data['category_id'] = $this->request->get['category_id'];
} else {
$data['category_id'] = 0;
}

$this->load->model('catalog/category');

// 3 Level Category Search
$data['categories'] = array();

$categories_1 = $this->model_catalog_category->getCategories(0);

foreach ($categories_1 as $category_1) {
$level_2_data = array();

$categories_2 = $this->model_catalog_category->getCategories($category_1['category_id']);

foreach ($categories_2 as $category_2) {
    $level_3_data = array();

    $categories_3 = $this->model_catalog_category->getCategories($category_2['category_id']);

    foreach ($categories_3 as $category_3) {
        $level_3_data[] = array(
            'category_id' => $category_3['category_id'],
            'name'        => $category_3['name'],
        );
    }

    $level_2_data[] = array(
        'category_id' => $category_2['category_id'],
        'name'        => $category_2['name'],
        'children'    => $level_3_data
    );
}

$data['categories'][] = array(
    'category_id' => $category_1['category_id'],
    'name'        => $category_1['name'],
    'children'    => $level_2_data
);
}
/*Default Theme changes END*/
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/extension/module/ajax_search_suggestions.php">
    <operation>
        <search><![CDATA[$this->document->addScript('catalog/view/theme/default/js/ajax_search_suggestions.js');]]></search>
        <add position="replace"><![CDATA[
$this->document->addScript('catalog/view/theme/awebcore/js/ajax_search_suggestions.js');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$this->document->addStyle('catalog/view/theme/default/stylesheet/ajax_search_suggestions.css');]]></search>
        <add position="replace"><![CDATA[
$this->document->addStyle('catalog/view/theme/awebcore/css/ajax_search_suggestions.css');
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/extension/module/bestseller.php">
    <operation>
        <search><![CDATA[$this->load->language]]></search>
        <add position="before"><![CDATA[
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.css');
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.transitions.css');
$this->document->addScript('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.min.js');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($result['special'] && $result['special'] > 0){
$discount = round(($result['price']-$result['special'])/$result['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/extension/module/homepage_products.php">
    <operation>
        <search><![CDATA[class ControllerExtensionModuleHomepageproducts extends Controller]]></search>
        <add position="before"><![CDATA[
if(!function_exists('collectionOrganizer')) {
    function collectionOrganizer($myCollection, $myKey, $uniqueKey = true, $keepField = 'all') {
        if(is_array($myCollection)) {
            $aResult = array();
            foreach($myCollection as $data) {
                if(is_object($data)) {
                    if($uniqueKey) {
                        $aResult[$data->$myKey] = ($keepField=='all')?$data:$data->$keepField;
                    } else {
                        $aResult[$data->$myKey][] = ($keepField=='all')?$data:$data->$keepField;
                    }
                } else {
                    if($uniqueKey) {
                        $aResult[$data[$myKey]] = ($keepField=='all')?$data:$data[$keepField];
                    } else {
                        $aResult[$data[$myKey]][] = ($keepField=='all')?$data:$data[$keepField];
                    }
                }
            }
            return $aResult;
        } else {
            return false;
        }
    }
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/extension/module/carousel.php">
    <operation>
        <search><![CDATA[$results = $this->model_design_banner->getBanner($setting['banner_id']);]]></search>
        <add position="before"><![CDATA[
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.css');
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.transitions.css');
$this->document->addScript('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.min.js');
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/extension/module/featured.php">
    <operation>
        <search><![CDATA[$this->load->language]]></search>
        <add position="before"><![CDATA[
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.css');
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.transitions.css');
$this->document->addScript('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.min.js');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'  => $this->url->link('product/quickview', 'product_id=' . $product_info['product_id'], '', true),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($product_info['special'] && $product_info['special'] > 0){
$discount = round(($product_info['price']-$product_info['special'])/$product_info['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/extension/module/latest.php">
    <operation>
        <search><![CDATA[$this->load->language]]></search>
        <add position="before"><![CDATA[
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.css');
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.transitions.css');
$this->document->addScript('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.min.js');
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($result['special'] && $result['special'] > 0){
$discount = round(($result['price']-$result['special'])/$result['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/extension/module/special.php">
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($result['special'] && $result['special'] > 0){
$discount = round(($result['price']-$result['special'])/$result['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/information/contact.php">
    <operation>
        <search><![CDATA[$data['locations'] = array();]]></search>
        <add position="before"><![CDATA[
/*Default Theme changes START*/
$data['map'] = $this->config->get($this->config->get('config_theme') . '_map');
$data['map_embed_url'] = '';
$contact_iframe = $this->config->get($this->config->get('config_theme') . '_map_embed_url');
if($contact_iframe){
$contact_iframe = trim(preg_replace("/[\n\r]/","",html_entity_decode($contact_iframe)));
preg_match('/<iframe.*src=\"(.*)\".*><\/iframe>/isU', $contact_iframe, $match);
if(isset($match[1]) && $match[1]){
    $data['map_embed_url'] = $match[1];
}
}
/*Default Theme changes END*/
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/product/category.php">
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($result['special'] && $result['special'] > 0){
$discount = round(($result['price']-$result['special'])/$result['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/product/compare.php">
    <operation>
        <search><![CDATA[$json['total']]]></search>
        <add position="before"><![CDATA[
$json['compare_total'] = sprintf($this->language->get('text_header_compare'), (isset($this->session->data['compare']) ? count($this->session->data['compare']) : 0));

$this->load->model('tool/image');
if ($product_info['image'])	{                
$json['image'] = $this->model_tool_image->resize($product_info['image'], 80, 80);
} else {
$json['image'] = $this->model_tool_image->resize('placeholder.png', 80, 80);
}
$json['text_compare'] = $this->language->get('heading_title');
$json['link_compare'] = $this->url->link('product/compare', '', true);
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/product/manufacturer.php">
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($result['special'] && $result['special'] > 0){
$discount = round(($result['price']-$result['special'])/$result['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/product/product.php">
    <operation>
        <search><![CDATA[$data['breadcrumbs'] = array();]]></search>
        <add position="before"><![CDATA[
/*Default Theme changes START*/
$this->document->addStyle('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.css');
$this->document->addScript('catalog/view/theme/awebcore/js/owl-carousel/owl.carousel.min.js');
/*Default Theme changes END*/
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['heading_title'] = $product_info['name']]]></search>
        <add position="before"><![CDATA[
/* Default Theme changes START */
$data['warranty_info_link'] = false;
$data['warranty_info_text'] = $this->language->get('text_warranty_info');
$colorix_warranty_information_id = $this->config->get('colorix_warranty_information_id');            
if($colorix_warranty_information_id) {
$data['warranty_info_link'] = $this->url->link('information/information', 'information_id=' .  $colorix_warranty_information_id);                
}
/* Default Theme changes END */
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($product_info['quantity'] <= 0)]]></search>
        <add position="before"><![CDATA[
/*Default Theme changes START*/
$data['quantity'] = $product_info['quantity'];
/*Default Theme changes END*/
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ((float)$product_info['special']) {]]></search>
        <add position="after"><![CDATA[
$data['discount'] = round(($product_info['price']-$product_info['special'])/$product_info['price']*100, 0);
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['special'] = false;]]></search>
        <add position="after"><![CDATA[
$data['discount'] = false;
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ((float)$result['special']) {]]></search>
        <add position="after"><![CDATA[
$discount = (($result['price']-$result['special'])/$result['price']*100);
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$special = false;]]></search>
        <add position="after"><![CDATA[
$discount = false;
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['reward']]]></search>
        <add position="before"><![CDATA[
$data['count_reviews'] = $product_info['reviews'];
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['reviews'] = sprintf($this->language->get('text_reviews'), (int)$product_info['reviews']);]]></search>
        <add position="replace"><![CDATA[
if(isset($product_info['reviews']) && !empty($product_info['reviews'])) {
$data['reviews'] = sprintf($this->language->get('text_reviews'), (int)$product_info['reviews']);

$all_ratings = $this->model_catalog_review->getRatingsByProductId($this->request->get['product_id']);
foreach ($all_ratings as $ratings) {
    $width = ($ratings['count'] * 100) / (int)$product_info['reviews'];
    $data['ratings'][$ratings['rating']] = array('count' => $ratings['count'] . '/' . (int)$product_info['reviews'],'width' => number_format((float)$width, 2, '.', ''));
}
} else {
$data['reviews'] = sprintf($this->language->get('text_reviews'), 0);
$data['ratings'] = array("1" => 0,"2" => 0,"3" => 0,"4" => 0,"5" => 0);
}
$data['carousel'] = 1; // In case we need to disable pagination
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['reviews'][]]]></search>
        <add position="before"><![CDATA[
$exp_name = explode(' ', $result['author']);
$initials = strtoupper($exp_name[0][0] . ((isset($exp_name[1]) ? $exp_name[1][0] : '')));
$nr = substr(strlen($result['author']), -1);
$id = $nr ? round($nr / 2) : 0;
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[$data['reviews'][] = array(]]></search>
        <add position="after"><![CDATA[
'author_initial' => $initials,
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/product/search.php">
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($result['special'] && $result['special'] > 0){
$discount = round(($result['price']-$result['special'])/$result['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/product/special.php">
    <operation>
        <search><![CDATA[$data['products'][] = array(]]></search>
        <add position="after"><![CDATA[
'quickview'   => $this->url->link('product/quickview', 'product_id=' . $result['product_id']),
'discount'    => $discount,
        ]]></add>
    </operation>
    <operation>
        <search><![CDATA[if ($this->config->get('config_tax'))]]></search>
        <add position="before"><![CDATA[
if ($result['special'] && $result['special'] > 0){
$discount = round(($result['price']-$result['special'])/$result['price']*100, 0);
} else{
$discount = false;
}
        ]]></add>
    </operation>
</file>
<file path="catalog/model/catalog/product.php">
    <operation>
        <search><![CDATA[public function getProfile($product_id]]></search>
        <add position="before"><![CDATA[
/* Colorix Start */
public function getTotalProductsByCategoryID() {

$sql = "SELECT cp.path_id as category_id, COUNT(DISTINCT p.product_id) as products FROM " . DB_PREFIX . "category_path cp LEFT JOIN " . DB_PREFIX . "product_to_category p2c ON (cp.category_id = p2c.category_id) LEFT JOIN " . DB_PREFIX . "product p ON (p2c.product_id = p.product_id) LEFT JOIN " . DB_PREFIX . "product_description pd ON (p.product_id = pd.product_id) LEFT JOIN " . DB_PREFIX . "product_to_store p2s ON (p.product_id = p2s.product_id) WHERE pd.language_id = '" . (int)$this->config->get('config_language_id') . "' AND p.status = '1' AND p.date_available <= NOW() AND p2s.store_id = '" . (int)$this->config->get('config_store_id') . "'";

if (!$this->config->get('config_show_out_stock')) {
    $sql .= " AND (p.quantity > '0' OR p.stock_status_id != '" . (int)$this->config->get('config_stock_status_out') . "')";
}

$sql .= " GROUP BY cp.path_id";

$query = $this->db->query($sql);

$total = array();
foreach($query->rows as $row) {
    $total[$row['category_id']] = $row['products'];
}

return $total;

}
/* Colorix END */
        ]]></add>
    </operation>
<operation>
<search><![CDATA[public function getProductAttributes($product_id)]]></search>
<add position="before"><![CDATA[
/* Colorix Start */
public function getRandomProducts($limit) {
$where = '';
if (!$this->config->get('config_show_out_stock')) {
$where .= "AND (p.quantity > '0' OR p.stock_status_id != '" . (int)$this->config->get('config_stock_status_out') . "')";
}
$query = $this->db->query("SELECT DISTINCT p.product_id FROM " . DB_PREFIX . "product p LEFT JOIN " . DB_PREFIX . "product_to_store p2s ON (p.product_id = p2s.product_id) LEFT JOIN " . DB_PREFIX . "product_to_category p2c ON (p.product_id = p2c.product_id) WHERE p.status = '1' AND p.date_available <= NOW() AND p2s.store_id = '" . (int)$this->config->get('config_store_id') . "' {$where} ORDER BY RAND() DESC, p.date_added DESC LIMIT " . (int)$limit);

return $query->rows;
}
/* Colorix END */
]]></add>
</operation>
</file>
<file path="catalog/language/en-gb/account/register.php">
    <operation>
        <search><![CDATA[$_['text_agree']           = 'I have read and agree to the <a href="%s" class="agree"><b>%s</b></a>';]]></search>
        <add position="replace"><![CDATA[
$_['text_agree']           = 'I have read and agree to the <a href="%s" class="agree"><b>%s</b></a>';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/account/wishlist.php">
    <operation>
        <search><![CDATA[$_['text_empty']]]></search>
        <add position="before"><![CDATA[
$_['text_button_wishlist'] = 'Wishlist';
$_['text_button_login']    = 'Login';
$_['text_button_register'] = 'Register';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/checkout/cart.php">
    <operation>
        <search><![CDATA[$_['text_points']]]></search>
        <add position="before"><![CDATA[
$_['text_items']               = '<div class="icon colorix-cart"><span class="notif">%s</span></div><div class="total-price"><span>%s</span></div><span class="icon colorix-chevron-down"></span>';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/common/cart.php">
    <operation>
        <search><![CDATA[$_['text_checkout']]]></search>
        <add position="before"><![CDATA[
$_['text_items'] = '<div class="icon colorix-cart"><span class="notif">%s</span></div><div class="total-price"><span>%s</span></div><span class="icon colorix-chevron-down"></span>';
$_['text_total']    = 'Total:';
$_['text_product']    = 'Product';
$_['text_products']    = 'Products';
$_['text_voucher']    = 'Voucher';
$_['text_vouchers']    = 'Vouchers';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/common/header.php">
    <operation>
        <search><![CDATA[$_['text_order']]]></search>
        <add position="before"><![CDATA[
$_['text_compare']       = 'Compare (%s)';
$_['text_hello']         = 'Hello,';
$_['text_logged']        = 'Hello, <span>%s</span>';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/common/search.php">
    <operation>
        <search><![CDATA[$_['text_search'] = 'Search';]]></search>
        <add position="before"><![CDATA[
/*theme_default Theme changes START*/
$_['text_category']   = 'All Categories';
/*theme_default Theme changes END*/
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/common/footer.php">
    <operation>
        <search><![CDATA[$_['text_powered']      = 'Powered By <a href="http://www.opencart.com">OpenCart</a><br /> %s &copy; %s';]]></search>
        <add position="replace"><![CDATA[
$_['text_powered']      = 'Powered By <a href="http://www.opencart.com">OpenCart</a> %s &copy; %s';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/common/maintenance.php">
    <operation>
        <search><![CDATA[$_['text_message']     = '<h1 style="text-align:center;">We are currently performing some scheduled maintenance. <br/>We will be back as soon as possible. Please check back soon.</h1>';]]></search>
        <add position="replace"><![CDATA[
$_['text_message']     = 'We are currently performing some scheduled maintenance. <br/>We will be back as soon as possible. Please check back soon.';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/en-gb.php">
    <operation>
        <search><![CDATA[$_['button_confirm']]]></search>
        <add position="before"><![CDATA[
$_['button_compare']        = 'Compare';
$_['button_wishlist']       = 'Wish List';
$_['button_cart']           = 'Buy now';
        ]]></add>
    </operation>
</file>
<file path="catalog/language/en-gb/product/product.php">
    <operation>
        <search><![CDATA[$_['text_year']]]></search>
        <add position="before"><![CDATA[
$_['text_discount']            = '% or more ';
        ]]></add>
    </operation>
</file>
<file path="catalog/model/catalog/review.php">
    <operation>
        <search><![CDATA[public function getTotalReviewsByProductId]]></search>
        <add position="before"><![CDATA[
        /* Colorix Start */
public function getRatingsByProductId($product_id) {
$query = $this->db->query("SELECT rating, COUNT(review_id) AS 'count' FROM " . DB_PREFIX . "review WHERE product_id = '" . (int)$product_id . "' AND status != '0' GROUP BY rating ORDER BY rating DESC");

return $query->rows;
}
/* Colorix END */
        ]]></add>
    </operation>
</file>
<file path="catalog/controller/account/address.php|catalog/controller/account/edit.php|catalog/controller/account/register.php|catalog/controller/account/return.php|catalog/controller/checkout/checkout.php|catalog/controller/product/product.php|catalog/controller/product/quickview.php">
    <operation>
        <search><![CDATA[$this->document->addScript('catalog/view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.js');]]></search>
        <add position="replace"><![CDATA[
$this->document->addScript('catalog/view/theme/awebcore/js/date-time-picker.js');
        ]]></add>
    </operation>
</file>